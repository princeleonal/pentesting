#!/usr/bin/python

import socket


def return_banner(ip, port):
    try:
        socket.setdefaulttimeout(2)
        s = socket.socket()
        s.connect((ip, port))
        banner = s.recv(1024).strip('/n')
        return banner
    except:
        return


def main():
    print("[+] Enter Target IP: ")
    ip = "192.168.31.160"
    for port in range(1, 100):
        banner = return_banner(ip, port)
        if banner:
            print("[+]" + ip + "/" + str(port) + " : " + banner.strip('/n'))


main()
