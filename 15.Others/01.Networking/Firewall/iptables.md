<h4>  Getting Started With Iptables </h4>

For Ubuntu or Debian
  
 sudo apt-get install iptables

For CentOS
sudo yum install iptables-services

For RHEL
  
 sudo yum install iptables

To know your iptables version, type the following command in your terminal.

    sudo iptables --version

Start & Stopping your iptables firewall
For OpenSUSE 42.1, type the following to stop.

    sudo /sbin/rcSuSEfirewall2 stop

To start it again

    sudo /sbin/rcSuSEfirewall2 start

For Ubuntu, type the following to stop.

    sudo service ufw stop

To start it again:

    sudo service ufw start

For Debian & RHEL , type the following to stop.

    sudo /etc/init.d/iptables stop

To start it again:

    sudo /etc/init.d/iptables start

For CentOS, type the following to stop.

    sudo service iptables stop

To start it again:

    sudo service iptables start

Getting all iptables rules lists
To know all the rules that is currently present & active in your iprables, simply open a terminal and type the following.

    sudo iptables -L

Type the following to know the status of the chains of your iptables firewall.

    sudo iptables -S

Clear all iptables rules
To clear all the rules from your iptables firewall, please type the following. This is normally known as flushing your iptables rules.

    sudo iptables -F

If you want to flush the INPUT chain only, or any individual chains, issue the below commands as per your requirements.

    sudo iptables -F INPUT
    sudo iptables -F OUTPUT
    sudo iptables -F FORWARD

    ACCEPT or DROP Chains

To accept or drop a particular chain, issue any of the following command on your terminal to meet your requirements.

    iptables --policy INPUT DROP

The above rule will not accept anything that is incoming to that server. To revert it again back to ACCEPT, do the following

    iptables --policy INPUT ACCEPT

Same goes for other chains as well like

    iptables --policy OUTPUT DROP
    iptables --policy FORWARD DROP

Note: By default, all chains of iptables ( INPUT, OUTPUT, FORWARD ) are in ACCEPT mode. This is known as Policy Chain Default Behavior.

Allowing any port:

If you are running any web server on your host, then you must allow your iptables firewall so that your server listen or respond to port 80. By default web server runs on port 80. Letâ€™s do that then.

    sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT


    sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT

Blocking any port:

Say we want to block port 135. We can do it by

    sudo iptables -A INPUT -p tcp --dport 135 -j DROP

    sudo iptables -A OUTPUT -p tcp --dport 22 -j DROP

To List The Rules That Exists In Present IPtables rules:

    sudo iptables -L

To Flush Out All The Rules:

    sudo iptables -F

To List The Rules in Numeric Format:

    sudo iptables -L -n -v
    n for numeric format

////////

    sudo iptables -A OUTPUT -j ACCEPT

    sudo iptables -A INPUT -s 192.168.1.11 -p tcp --dropt 22 -j ACCEPT

    sudo iptables -A INPUT -s 192.168.1.11 -p tcp --dport 4545 -j ACCEPT

This DROPS All The TCP Incoming Packets:

    sudo iptables -A INPUT -p tcp -j DROP

Blocking eamil receiving:

    sudo iptables -A INPUT -s 192.168.1.11 -p tcp --dport 993 -j DROP

Blocking eamil sending:

    sudo iptables -A OUTPUT -s 192.168.1.2 -p tcp --dport 25 -j DROP

To Save Or Backup The Existing Rules:

    sudo iptables-save > rules-backup

To Restore The backup Rules:

    sudo iptables-restore rules-backup

<h3> blocking ssh connection port from specific ip: </h3>

     sudo iptables -A INPUT -s 192.168.1.3 -p tcp --destination-port 22 -j DROP
                                (or)
     sudo iptables -A INPUT -s 192.168.1.3 -p tcp --dport 22 -j DROP

Allowing specific IP with Port:
  
 sudo iptables -A INPUT -p tcp -s 0/0 --dport 22 -j ACCEPT

    sudo iptables -A INPUT -p tcp -s 12.12.12.12/32 --dport 22  -j ACCEPT

On the above example, you are only allowing 12.12.12.12 IP address to connect to port SSH. Rest IP addresses will not be able to connect to port 22. Similarly you can allow by using CIDR values. Such as

    sudo iptables -A INPUT -p tcp -s 12.12.12.0/24 --dport 22  -j ACCEPT

The above example show how you can allow a whole IP block for accepting connection on port 22. It will accept IP starting from 12.12.12.1 to 12.12.12.255.

If you want to block such IP addresses range, do the reverse by replacing ACCEPT by DROP like the following

    sudo iptables -A INPUT -p tcp -s 12.12.12.0/24 --dport 22  -j DROP

So, it will not allow to get a connection on port 22 from from 12.12.12.1 to 12.12.12.255 IP addresses.

Block DDoS:

    iptables -A INPUT -p tcp --dport 80 -m limit --limit 20/minute --limit-burst 100 -j ACCEPT

Blocking ICMP:

If you want to block ICMP (ping) request to and from on your server, you can try the following. The first one will block not to send ICMP ping echo request to another host.

    sudo iptables -A OUTPUT -p icmp --icmp-type 8 -j DROP

Now, try to ping google.com. Your OpenSUSE server will not be able to ping google.com.

If you want block the incoming ICMP (ping) echo request for your server, just type the following on your terminal.

    sudo iptables -I INPUT -p icmp --icmp-type 8 -j DROP

Blocking MySql / MariaDB Port:

As Mysql is holding your database so you must protect your database from outside attach. Allow your trusted application server IP addresses only to connect with your MySQL server. To block other

    sudo iptables -A INPUT -p tcp -s 192.168.1.0/24 --dport 3306 -m state --state NEW,ESTABLISHED -j ACCEPT

So, it will not take any MySql connection except 192.168.1.0/24 IP block. By default MySql runs on 3306 port.

Blocking SMTP:

If you not running any mail server on your host server or if your server is not configured to act like a mail server, you must block SMTP so that your server is not sending any spam or any mail towards any domain. You must do this to block any outgoing mail from your server. To do so,

    sudo iptables -A OUTPUT -p tcp --dport 25 -j DROP

https://www.unixmen.com/iptables-vs-firewalld/
